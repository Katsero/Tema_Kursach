<!-- music/templates/pending_tracks.html -->
{% extends "base.html" %}
{% block title %}К одобрению{% endblock %}
{% block content %}
<div class="header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
  <h1>Треки к одобрению</h1>
</div>

{% if page_obj %}
  {% for track in page_obj %}
    <div class="track-card" style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
      <h3>{{ track.title }}</h3>
      <div class="track-meta" style="color: #555; margin: 10px 0;">
        <p><strong>Загрузил:</strong> {{ track.uploaded_by.email }}</p>
        <p><strong>Жанры:</strong>
          {% for g in track.genres.all %}{{ g.name }}{% if not forloop.last %}, {% endif %}{% empty %}—{% endfor %}
        </p>
        <p><strong>Исполнители:</strong>
          {% for a in track.artists.all %}{{ a.name }}{% if not forloop.last %}, {% endif %}{% empty %}—{% endfor %}
        </p>
      </div>
      <div class="actions" style="margin-top: 10px;">
        <audio controls style="width: 100%"><source src="{{ track.audio_file.url }}" type="audio/mpeg"></audio>
        <a href="{% url 'approve_track' track.id %}" class="btn-approve" onclick="return confirm('Одобрить трек?')" style="background: #28a745; color: white; padding: 4px 8px; border-radius: 4px; text-decoration: none; margin-right: 15px;">Одобрить</a>
        <a href="{% url 'delete_track' track.id %}" class="btn-delete" onclick="return confirm('Удалить трек?')" style="background: #dc3545; color: white; padding: 4px 8px; border-radius: 4px; text-decoration: none;">Удалить</a>
      </div>
    </div>
  {% empty %}
    <p>Нет треков на модерации.</p>
  {% endfor %}

  <div class="pagination" style="text-align: center; margin-top: 20px;">
    {% if page_obj.has_previous %}
      <a href="?page=1" style="display: inline-block; padding: 8px 12px; margin: 0 5px; border: 1px solid #ddd; border-radius: 4px;">« Первая</a>
      <a href="?page={{ page_obj.previous_page_number }}" style="display: inline-block; padding: 8px 12px; margin: 0 5px; border: 1px solid #ddd; border-radius: 4px;">‹ Предыдущая</a>
    {% endif %}
    <span class="current" style="display: inline-block; padding: 8px 12px; margin: 0 5px; border: 1px solid #007bff; background: #007bff; color: white; border-radius: 4px;">Стр. {{ page_obj.number }} из {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
      <a href="?page={{ page_obj.next_page_number }}" style="display: inline-block; padding: 8px 12px; margin: 0 5px; border: 1px solid #ddd; border-radius: 4px;">Следующая ›</a>
      <a href="?page={{ page_obj.paginator.num_pages }}" style="display: inline-block; padding: 8px 12px; margin: 0 5px; border: 1px solid #ddd; border-radius: 4px;">Последняя »</a>
    {% endif %}
  </div>
{% endif %}
{% endblock %}